<!DOCTYPE html>
<html prefix="" lang="pt_br">
<head>
<meta charset="utf-8">
<meta name="description" content="knn_eucl_cos.py">
<meta name="viewport" content="width=device-width">
<title>knn_eucl_cos.py | Anotações sobre NLP</title>
<link href="../assets/css/rst.css" rel="stylesheet" type="text/css">
<link href="../assets/css/code.css" rel="stylesheet" type="text/css">
<link href="../assets/css/dark.css" rel="stylesheet" type="text/css">
<link href="../assets/css/theme.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Share+Tech+Mono" rel="stylesheet">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" href="../rss.xml">
<link rel="canonical" href="http://demacdolincoln.github.io/anotacoes-nlp/listings/knn_eucl_cos.py.html">
<!--[if lt IE 9]><script src="../assets/js/html5.js"></script><![endif]--><script src="https://cdn.jsdelivr.net/npm/vega@4.4.0"></script><script src="https://cdn.jsdelivr.net/npm/vega-lite@2.6.0"></script><script src="https://cdn.jsdelivr.net/npm/vega-embed@3.24.2"></script><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/highlight.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/languages/python.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.5/languages/julia.min.js"></script><script>hljs.initHighlightingOnLoad();</script>
</head>
<body class="hack dark">

<a href="#content" class="sr-only sr-only-focusable">Pular para o conteúdo principal</a>
    <div id="container">
         
    <header id="header"><h1 id="brand"><a href="http://demacdolincoln.github.io/anotacoes-nlp/" title="Anotações sobre NLP" rel="home">

        <span id="blog-title">Anotações sobre NLP</span>
    </a></h1>

        

        
    <nav id="menu"><ul>
<li><a href="../archive.html">Arquivo</a></li>
                <li><a href="../categories/">Etiqueta</a></li>
                <li><a href="../rss.xml">Feed RSS</a></li>

    

    
    
    </ul></nav></header><main id="content"><nav class="breadcrumbs"><ul class="breadcrumb">
<li><a href=".">listings</a></li>
                <li>knn_eucl_cos.py</li>
</ul></nav><h1>knn_eucl_cos.py
            <small><a href="knn_eucl_cos.py">(Código)</a></small>
        </h1>
    <table class="codetable"><tr>
<td class="linenos"><div class="linenodiv"><pre><a href="#listingsknn_eucl_cospy-1"> 1</a>
<a href="#listingsknn_eucl_cospy-2"> 2</a>
<a href="#listingsknn_eucl_cospy-3"> 3</a>
<a href="#listingsknn_eucl_cospy-4"> 4</a>
<a href="#listingsknn_eucl_cospy-5"> 5</a>
<a href="#listingsknn_eucl_cospy-6"> 6</a>
<a href="#listingsknn_eucl_cospy-7"> 7</a>
<a href="#listingsknn_eucl_cospy-8"> 8</a>
<a href="#listingsknn_eucl_cospy-9"> 9</a>
<a href="#listingsknn_eucl_cospy-10">10</a>
<a href="#listingsknn_eucl_cospy-11">11</a>
<a href="#listingsknn_eucl_cospy-12">12</a>
<a href="#listingsknn_eucl_cospy-13">13</a>
<a href="#listingsknn_eucl_cospy-14">14</a>
<a href="#listingsknn_eucl_cospy-15">15</a>
<a href="#listingsknn_eucl_cospy-16">16</a>
<a href="#listingsknn_eucl_cospy-17">17</a>
<a href="#listingsknn_eucl_cospy-18">18</a>
<a href="#listingsknn_eucl_cospy-19">19</a>
<a href="#listingsknn_eucl_cospy-20">20</a>
<a href="#listingsknn_eucl_cospy-21">21</a>
<a href="#listingsknn_eucl_cospy-22">22</a>
<a href="#listingsknn_eucl_cospy-23">23</a>
<a href="#listingsknn_eucl_cospy-24">24</a>
<a href="#listingsknn_eucl_cospy-25">25</a>
<a href="#listingsknn_eucl_cospy-26">26</a>
<a href="#listingsknn_eucl_cospy-27">27</a>
<a href="#listingsknn_eucl_cospy-28">28</a>
<a href="#listingsknn_eucl_cospy-29">29</a>
<a href="#listingsknn_eucl_cospy-30">30</a>
<a href="#listingsknn_eucl_cospy-31">31</a>
<a href="#listingsknn_eucl_cospy-32">32</a></pre></div></td>
<td class="code"><pre class="code literal-block"><a name="listingsknn_eucl_cospy-1"></a><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<a name="listingsknn_eucl_cospy-2"></a>
<a name="listingsknn_eucl_cospy-3"></a><span class="k">def</span> <span class="nf">dist_eucl</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<a name="listingsknn_eucl_cospy-4"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">a</span><span class="o">-</span><span class="n">b</span><span class="p">)</span>
<a name="listingsknn_eucl_cospy-5"></a>
<a name="listingsknn_eucl_cospy-6"></a><span class="k">def</span> <span class="nf">cos_siml</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<a name="listingsknn_eucl_cospy-7"></a>    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">))</span><span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">a</span><span class="p">)))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">b</span><span class="p">))))</span>
<a name="listingsknn_eucl_cospy-8"></a>
<a name="listingsknn_eucl_cospy-9"></a><span class="k">def</span> <span class="nf">norm</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<a name="listingsknn_eucl_cospy-10"></a>    <span class="k">return</span> <span class="n">x</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<a name="listingsknn_eucl_cospy-11"></a>
<a name="listingsknn_eucl_cospy-12"></a><span class="k">def</span> <span class="nf">knn</span><span class="p">(</span><span class="n">matrix</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">func</span><span class="o">=</span><span class="s2">"cos"</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
<a name="listingsknn_eucl_cospy-13"></a>    <span class="n">data_norm</span><span class="p">,</span> <span class="n">coord_norm</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span>
<a name="listingsknn_eucl_cospy-14"></a>    
<a name="listingsknn_eucl_cospy-15"></a>    <span class="k">if</span> <span class="s2">"coord"</span> <span class="ow">in</span> <span class="n">kw</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
<a name="listingsknn_eucl_cospy-16"></a>        <span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">matrix</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">kw</span><span class="p">[</span><span class="s2">"coord"</span><span class="p">]])))</span>
<a name="listingsknn_eucl_cospy-17"></a>        <span class="n">data_norm</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>
<a name="listingsknn_eucl_cospy-18"></a>        <span class="n">coord_norm</span> <span class="o">=</span> <span class="n">data_norm</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span>
<a name="listingsknn_eucl_cospy-19"></a>    <span class="k">else</span><span class="p">:</span>
<a name="listingsknn_eucl_cospy-20"></a>        <span class="n">data_norm</span> <span class="o">=</span> <span class="n">norm</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>
<a name="listingsknn_eucl_cospy-21"></a>        <span class="n">coord_norm</span> <span class="o">=</span> <span class="n">data_norm</span><span class="p">[</span><span class="n">kw</span><span class="p">[</span><span class="s2">"pos"</span><span class="p">]]</span>
<a name="listingsknn_eucl_cospy-22"></a>    
<a name="listingsknn_eucl_cospy-23"></a>    <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
<a name="listingsknn_eucl_cospy-24"></a>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">data_norm</span><span class="p">:</span>
<a name="listingsknn_eucl_cospy-25"></a>        <span class="k">if</span> <span class="n">func</span><span class="o">==</span><span class="s2">"cos"</span><span class="p">:</span>
<a name="listingsknn_eucl_cospy-26"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cos_siml</span><span class="p">(</span><span class="n">coord_norm</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
<a name="listingsknn_eucl_cospy-27"></a>        <span class="k">else</span><span class="p">:</span>
<a name="listingsknn_eucl_cospy-28"></a>            <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dist_eucl</span><span class="p">(</span><span class="n">coord_norm</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
<a name="listingsknn_eucl_cospy-29"></a>    <span class="k">if</span> <span class="n">func</span><span class="o">==</span><span class="s2">"cos"</span><span class="p">:</span>
<a name="listingsknn_eucl_cospy-30"></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">res</span><span class="p">)</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[::</span><span class="o">-</span><span class="mi">1</span><span class="p">][:</span><span class="n">n</span><span class="p">],</span> <span class="n">res</span>
<a name="listingsknn_eucl_cospy-31"></a>    <span class="k">else</span><span class="p">:</span>
<a name="listingsknn_eucl_cospy-32"></a>        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">res</span><span class="p">)</span><span class="o">.</span><span class="n">argsort</span><span class="p">()[:</span><span class="n">n</span><span class="p">],</span> <span class="n">res</span>
</pre></td>
</tr></table></main><footer id="footer"><p>Contents © 2018         <a href="mailto:demacdolincoln@gmail.com">Lincoln de Macêdo</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         </p>
            
        </footer>
</div>
    
    

    
    
    
</body>
</html>
